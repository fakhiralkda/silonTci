kind: pipeline
name: n11

steps:
- name: compile-test
  image: fadlyas/kernel_dockerfile:latest
  environment:
    TOKED:
      from_secret: TOKED
    CHATID:
      from_secret: CHATID
    ORIGIN:
      from_secret: ORIGIN
  commands:
  - apt update -qq -y && apt install -qq -y openjdk-11-jre-headless
  - curl -LSs https://android.googlesource.com/platform/prebuilts/misc/+archive/master/linux-x86/libufdt.tar.gz | tar -C temp/ -xzf -
  - export PATH=$PATH:$(pwd)temp/mkdtimg
  - git clone -qq --depth=1 $ORIGIN -b n11 silont
  - cd silont
  - wget -q https://github.com/rzlamrr/scripts/raw/master/KERNEL/compile.sh
  - chmod +x compile.sh
  - bash compile.sh -c silont -ci drone -d vendor/ginkgo-perf_defconfig -cn Test
  - ls -a
  - ls out/
  - ls out/arch/arm64/boot
